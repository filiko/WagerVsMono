// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id              String    @id @default(cuid())
  email           String?   @unique
  name            String?
  avatar          String?
  googleId        String?   @unique
  solanaPublicKey String?   @unique
  provider        String?   // "google" | "solana"
  role            String    @default("user") // "user" | "admin"
  lastLogin       DateTime?
  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt

  // Relations
  aiPredictionLogs AiPredictionLog[]

  @@map("users")
}

model AiPredictionLog {
  id               Int       @id @default(autoincrement())
  wagerId          String
  title            String
  confidencePct    Float?
  modelProvider    String
  modelName        String
  modelVersion     String?
  createdUtc       DateTime
  serverReceivedUtc DateTime
  appEnv           String
  cid0g            String?
  integritySha256  String?
  createdAt        DateTime  @default(now())

  // Relations
  user             User?     @relation(fields: [userId], references: [id])
  userId           String?

  @@map("ai_prediction_logs")
}
